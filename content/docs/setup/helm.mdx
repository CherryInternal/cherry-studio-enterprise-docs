---
title: Helm éƒ¨ç½²
description: ä½¿ç”¨ Helm å°† Cherry Studio Enterprise éƒ¨ç½²åˆ° Kubernetes é›†ç¾¤
---

è¿™ä¸ª Helm Chart ç”¨äºéƒ¨ç½² Cherry Studio Enterprise å®Œæ•´è§£å†³æ–¹æ¡ˆåˆ° Kubernetes é›†ç¾¤ï¼ŒåŒ…æ‹¬ API æœåŠ¡å’Œç®¡ç†åå°ã€‚

## ç‰¹æ€§

- **åŒæœåŠ¡éƒ¨ç½²**ï¼šåŒæ—¶éƒ¨ç½² API æœåŠ¡å’Œç®¡ç†åå°ï¼ˆAdminï¼‰
- **API æœåŠ¡**ï¼šåŸºäº PostgreSQL æ•°æ®åº“çš„åç«¯ APIï¼Œæ”¯æŒä¼ä¸šçº§æ•°æ®å­˜å‚¨
- **ç®¡ç†åå°**ï¼šåŸºäº Web çš„ç®¡ç†ç•Œé¢
- **æ•°æ®åº“æ”¯æŒ**ï¼šæ”¯æŒ PostgreSQL æ•°æ®åº“ï¼Œæä¾›é«˜å¯ç”¨æ€§å’Œæ‰©å±•æ€§
- **ç‹¬ç«‹é…ç½®**ï¼šæ¯ä¸ªæœåŠ¡éƒ½å¯ä»¥ç‹¬ç«‹å¯ç”¨/ç¦ç”¨å’Œé…ç½®
- **è‡ªåŠ¨æ‰©å±•**ï¼šæ”¯æŒ HPAï¼ˆæ°´å¹³ Pod è‡ªåŠ¨æ‰©å±•ï¼‰
- **å¥åº·æ£€æŸ¥**ï¼šåŒ…å« liveness å’Œ readiness æ¢é’ˆ
- **Ingress æ”¯æŒ**ï¼šä¸ºæ¯ä¸ªæœåŠ¡é…ç½®ç‹¬ç«‹çš„ Ingress è§„åˆ™

## è·å– Helm Chart

### æ–¹å¼ä¸€ï¼šä¸‹è½½å‘å¸ƒç‰ˆæœ¬ï¼ˆæ¨èï¼‰

ä» GitHub Releases é¡µé¢ä¸‹è½½æœ€æ–°çš„ Helm Chartï¼š

```bash
# ä¸‹è½½æœ€æ–°ç‰ˆæœ¬
wget https://github.com/CherryInternal/cherry-studio-enterprise-helm/archive/refs/heads/main.zip
unzip main.zip
cd cherry-studio-enterprise-helm-main

# å®‰è£…
helm install cherry-studio-enterprise ./helm
```

### æ–¹å¼äºŒï¼šä½¿ç”¨ Git Clone

```bash
# å…‹éš†æœ€æ–°ç‰ˆæœ¬
git clone https://github.com/CherryInternal/cherry-studio-enterprise-helm.git
cd cherry-studio-enterprise-helm

# å®‰è£…
helm install cherry-studio-enterprise ./helm
```

ğŸ“¦ **Helm Chart å‘å¸ƒé¡µé¢**: [cherry-studio-enterprise-helm/releases](https://github.com/CherryInternal/cherry-studio-enterprise-helm/releases)

ğŸ³ **Docker é•œåƒ**: [cherrystudio/cherry-studio-enterprise-api](https://hub.docker.com/repository/docker/cherrystudio/cherry-studio-enterprise-api) - æŸ¥çœ‹å¯ç”¨çš„é•œåƒæ ‡ç­¾

## å®‰è£…

### å‰ç½®æ¡ä»¶

- Kubernetes 1.16+
- Helm 3.0+
- é›†ç¾¤ä¸­éœ€è¦æ”¯æŒ PVC

### åŸºæœ¬å®‰è£…

æ ¹æ®ä½ è·å– Helm Chart çš„æ–¹å¼ï¼Œé€‰æ‹©ç›¸åº”çš„å®‰è£…å‘½ä»¤ï¼š

**å¦‚æœä¸‹è½½äº†å‘å¸ƒç‰ˆæœ¬ï¼š**

```bash
# è¿›å…¥è§£å‹åçš„ç›®å½•
cd cherry-studio-enterprise-helm-main

# å®‰è£… chartï¼ˆæ³¨æ„ä½¿ç”¨ ./helm ç›®å½•ï¼‰
helm install cherry-studio-enterprise ./helm

# æˆ–è€…æŒ‡å®šå‘½åç©ºé—´
helm install cherry-studio-enterprise ./helm --namespace cherry-studio --create-namespace
```

**å¦‚æœä½¿ç”¨ git cloneï¼š**

```bash
# è¿›å…¥å…‹éš†çš„ç›®å½•
cd cherry-studio-enterprise-helm

# å®‰è£… chart
helm install cherry-studio-enterprise ./helm

# æˆ–è€…æŒ‡å®šå‘½åç©ºé—´
helm install cherry-studio-enterprise ./helm --namespace cherry-studio --create-namespace
```

### è‡ªå®šä¹‰å®‰è£…

åˆ›å»ºä¸€ä¸ª `values-custom.yaml` æ–‡ä»¶æ¥è¦†ç›–é»˜è®¤é…ç½®ï¼š

```yaml
app:
  # API æœåŠ¡é…ç½®
  api:
    ingress:
      enabled: true
      annotations:
        nginx.ingress.kubernetes.io/proxy-body-size: '20m'
      hosts:
        - host: api.your-domain.com
          paths:
            - path: /
              pathType: ImplementationSpecific

  # Admin åå°é…ç½®
  admin:
    ingress:
      enabled: true
      annotations:
        nginx.ingress.kubernetes.io/proxy-body-size: '20m'
      hosts:
        - host: admin.your-domain.com
          paths:
            - path: /
              pathType: ImplementationSpecific

  # å­˜å‚¨é…ç½®ï¼ˆå¯é€‰ï¼‰
  persistence:
    size: 20Gi

  # ç¯å¢ƒé…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»ï¼‰
  env:
    API_URL: http://cherry-studio-enterprise-api.test # æ›´æ”¹æˆåç«¯ API åœ°å€
    JWT_SECRET: 'your-secure-jwt-secret-at-least-32-characters-long'
    DB_HOST: database.host
    DB_PORT: 5432
    DB_USERNAME: username
    DB_PASSWORD: password
    DB_NAME: database
    DB_TYPE: postgres

  # èµ„æºé…ç½®ï¼ˆå¯é€‰ï¼‰
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 256Mi
```

ç„¶åä½¿ç”¨è‡ªå®šä¹‰é…ç½®å®‰è£…ï¼š

```bash
helm install cherry-studio-enterprise ./helm -f values-custom.yaml
```

## é…ç½®è¯´æ˜

### å¸¸è§é…ç½®åœºæ™¯

| åœºæ™¯           | é…ç½®è¦ç‚¹                        | ç¤ºä¾‹                                           |
| -------------- | ------------------------------- | ---------------------------------------------- |
| **å¼€å‘/æµ‹è¯•**  | ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œport-forward è®¿é—® | `helm install cherry-studio-enterprise ./helm` |
| **äº‘å¹³å°éƒ¨ç½²** | è®¾ç½® LoadBalancer               | `service.type: LoadBalancer`                   |
| **æœ¬åœ°é›†ç¾¤**   | è®¾ç½® NodePort                   | `service.type: NodePort`                       |
| **ç”Ÿäº§ç¯å¢ƒ**   | Ingress + è‡ªå®šä¹‰ JWT å¯†é’¥       | è§ä¸Šæ–¹å®Œæ•´é…ç½®ç¤ºä¾‹                             |
| **å¤§é‡æ•°æ®**   | å¢åŠ å­˜å‚¨å¤§å°                    | `persistence.size: 50Gi`                       |
| **é«˜å¯ç”¨æ€§**   | é…ç½®èµ„æºé™åˆ¶å’Œæ¢é’ˆ              | é»˜è®¤å·²é…ç½®ï¼Œå¯æ ¹æ®éœ€è¦è°ƒæ•´                     |

### è¯¦ç»†é…ç½®å‚æ•°

#### åº”ç”¨æœåŠ¡é…ç½®

| å‚æ•°                            | æè¿°                                    | é»˜è®¤å€¼                                      |
| ------------------------------- | --------------------------------------- | ------------------------------------------- |
| `app.enabled`                   | æ˜¯å¦å¯ç”¨åº”ç”¨æœåŠ¡                        | `true`                                      |
| `app.replicaCount`              | å‰¯æœ¬æ•°é‡ï¼ˆæ¨èè®¾ç½®ä¸º1ä»¥ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼‰ | `1`                                         |
| `app.image.repository`          | åº”ç”¨é•œåƒä»“åº“                            | `cherrystudio/cherry-studio-enterprise-api` |
| `app.image.tag`                 | åº”ç”¨é•œåƒæ ‡ç­¾                            | `latest`                                    |
| `app.api.service.type`          | API Service ç±»å‹                        | `ClusterIP`                                 |
| `app.api.service.port`          | API æœåŠ¡ç«¯å£                            | `3670`                                      |
| `app.api.service.targetPort`    | API å®¹å™¨ç«¯å£                            | `3670`                                      |
| `app.admin.service.type`        | Admin Service ç±»å‹                      | `ClusterIP`                                 |
| `app.admin.service.port`        | Admin æœåŠ¡ç«¯å£                          | `3680`                                      |
| `app.admin.service.targetPort`  | Admin å®¹å™¨ç«¯å£                          | `3680`                                      |
| `app.persistence.enabled`       | æ˜¯å¦å¯ç”¨æŒä¹…åŒ–å­˜å‚¨                      | `true`                                      |
| `app.persistence.size`          | å­˜å‚¨å¤§å°                                | `10Gi`                                      |
| `app.persistence.accessMode`    | å­˜å‚¨è®¿é—®æ¨¡å¼                            | `ReadWriteOnce`                             |
| `app.persistence.mountPath`     | æ•°æ®æŒ‚è½½è·¯å¾„                            | `/app/data`                                 |
| `app.api.ingress.enabled`       | æ˜¯å¦å¯ç”¨ API Ingress                    | `true`                                      |
| `app.admin.ingress.enabled`     | æ˜¯å¦å¯ç”¨ Admin Ingress                  | `true`                                      |
| `app.resources.limits.cpu`      | CPU é™åˆ¶                                | `500m`                                      |
| `app.resources.limits.memory`   | å†…å­˜é™åˆ¶                                | `512Mi`                                     |
| `app.resources.requests.cpu`    | CPU è¯·æ±‚                                | `100m`                                      |
| `app.resources.requests.memory` | å†…å­˜è¯·æ±‚                                | `128Mi`                                     |
| `app.env.*`                     | åº”ç”¨ç¯å¢ƒå˜é‡é…ç½®                        | è§ä¸‹æ–¹ç¯å¢ƒå˜é‡è¯´æ˜                          |

#### ç«¯å£è¯´æ˜

æœ¬åº”ç”¨åœ¨å•ä¸ªå®¹å™¨ä¸­è¿è¡Œä¸¤ä¸ªæœåŠ¡ï¼š

| ç«¯å£ | æœåŠ¡ç±»å‹   | æè¿°                                 |
| ---- | ---------- | ------------------------------------ |
| 3670 | API æœåŠ¡   | æä¾› RESTful API æ¥å£ï¼Œç”¨äºæ•°æ®äº¤äº’  |
| 3680 | Admin åå° | æä¾›ç®¡ç†åå°ç•Œé¢ï¼Œç”¨äºç³»ç»Ÿç®¡ç†å’Œé…ç½® |

### ç¯å¢ƒå˜é‡

Chart åŒ…å«äº†æ‰€æœ‰å¿…éœ€çš„ç¯å¢ƒå˜é‡é…ç½®ã€‚ä»¥ä¸‹æ˜¯ä¸»è¦ç¯å¢ƒå˜é‡ï¼š

#### API æœåŠ¡ç¯å¢ƒå˜é‡

| ç¯å¢ƒå˜é‡             | æè¿°               | é»˜è®¤å€¼                                                   |
| -------------------- | ------------------ | -------------------------------------------------------- |
| `API_URL`            | ç®¡ç†åå°APIåŸºç¡€URL | `http://cherry-studio-enterprise-api.test`               |
| `API_PORT`           | API æœåŠ¡ç«¯å£       | `3670`                                                   |
| `ADMIN_PORT`         | Admin åå°ç«¯å£     | `3680`                                                   |
| `ADMIN_APP_NAME`     | ç®¡ç†åå°åº”ç”¨åç§°   | `Cherry Studio`                                          |
| `ADMIN_APP_LOGO_URL` | ç®¡ç†åå°Logo URL   | `https://img.picui.cn/free/2025/07/07/686ab9a2b7825.png` |
| `ADMIN_BASE_PATH`    | ç®¡ç†åå°åŸºç¡€è·¯å¾„   | `/`                                                      |
| `JWT_SECRET`         | JWT å¯†é’¥           | `your-secure-jwt-secret-at-least-32-characters`          |

#### æ•°æ®åº“ç¯å¢ƒå˜é‡

| ç¯å¢ƒå˜é‡      | æè¿°           | é»˜è®¤å€¼                     |
| ------------- | -------------- | -------------------------- |
| `DB_HOST`     | æ•°æ®åº“ä¸»æœºåœ°å€ | `1panel.cherry-ai.com`     |
| `DB_PORT`     | æ•°æ®åº“ç«¯å£     | `5432`                     |
| `DB_USERNAME` | æ•°æ®åº“ç”¨æˆ·å   | `cherry-studio-enterprise` |
| `DB_PASSWORD` | æ•°æ®åº“å¯†ç      | `your-secure-password`     |
| `DB_NAME`     | æ•°æ®åº“åç§°     | `cherry-studio-enterprise` |
| `DB_TYPE`     | æ•°æ®åº“ç±»å‹     | `postgres`                 |
| `DB_SSL`      | æ˜¯å¦å¯ç”¨SSL    | `false`                    |

**âš ï¸ é‡è¦æé†’**ï¼š

- ç”Ÿäº§ç¯å¢ƒä¸­å¿…é¡»æ›´æ¢é»˜è®¤çš„ JWT_SECRETï¼
- ç”Ÿäº§ç¯å¢ƒä¸­å¿…é¡»é…ç½®æ‚¨è‡ªå·±çš„ PostgreSQL æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼
- æ•°æ®åº“å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯åº”ä½¿ç”¨ Kubernetes Secret ç®¡ç†ï¼

ä½ å¯ä»¥é€šè¿‡ `app.env` éƒ¨åˆ†æ¥è¦†ç›–è¿™äº›é…ç½®ï¼Œä¾‹å¦‚ï¼š

```yaml
app:
  env:
    JWT_SECRET: 'your-custom-jwt-secret'
    ADMIN_APP_NAME: 'æ‚¨çš„åº”ç”¨åç§°'
    DB_HOST: 'your-postgres-host'
    DB_USERNAME: 'your-username'
    DB_PASSWORD: 'your-password'
    DB_NAME: 'your-database'
```

**æ³¨æ„**ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®ä½¿ç”¨ Kubernetes Secret æ¥ç®¡ç†æ•æ„Ÿä¿¡æ¯ã€‚

## éƒ¨ç½²éªŒè¯

å®‰è£…å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤éªŒè¯éƒ¨ç½²ï¼š

```bash
# æ£€æŸ¥ pod çŠ¶æ€
kubectl get pods -l app.kubernetes.io/name=cherry-studio-enterprise

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
kubectl get svc -l app.kubernetes.io/name=cherry-studio-enterprise

# æ£€æŸ¥æŒä¹…åŒ–å·
kubectl get pvc

# è¿è¡Œè¿æ¥æµ‹è¯•
helm test cherry-studio-enterprise
```

### éƒ¨ç½²æ£€æŸ¥æ¸…å•

- **Pod çŠ¶æ€**: æ‰€æœ‰ Pod éƒ½æ˜¯ Running çŠ¶æ€
- **Service çŠ¶æ€**: Service æ­£å¸¸åˆ›å»ºå¹¶æœ‰å¯¹åº”çš„ Endpoints
- **PVC çŠ¶æ€**: PVC å·²ç»‘å®šåˆ°å¯ç”¨çš„ PV
- **Ingress çŠ¶æ€**: å¦‚æœå¯ç”¨äº† Ingressï¼Œæ£€æŸ¥æ˜¯å¦æ­£å¸¸åˆ›å»º
- **å¥åº·æ£€æŸ¥**: API æœåŠ¡å“åº”å¥åº·æ£€æŸ¥è¯·æ±‚
- **æ•°æ®æŒä¹…åŒ–**: é‡å¯ Pod åæ•°æ®ä»ç„¶å­˜åœ¨
- **JWT é…ç½®**: ç”Ÿäº§ç¯å¢ƒä¸­å·²æ›´æ¢é»˜è®¤çš„ JWT_SECRET

## è®¿é—®åº”ç”¨

### ä½¿ç”¨ Port-Forwardï¼ˆæ¨èç”¨äºæµ‹è¯•ï¼‰

**API æœåŠ¡ï¼š**

```bash
kubectl port-forward svc/cherry-studio-enterprise-api 3670:3670
```

ç„¶åè®¿é—® `http://localhost:3670`

**Admin åå°ï¼š**

```bash
kubectl port-forward svc/cherry-studio-enterprise-admin 3680:3680
```

ç„¶åè®¿é—® `http://localhost:3680`

### ä½¿ç”¨ LoadBalancer

å¦‚æœé…ç½®äº† LoadBalancer ç±»å‹çš„ Serviceï¼š

**API æœåŠ¡ï¼š**

```bash
kubectl get svc cherry-studio-enterprise-api
```

è·å– EXTERNAL-IP åè®¿é—® `http://EXTERNAL-IP:3670`

**Admin åå°ï¼š**

```bash
kubectl get svc cherry-studio-enterprise-admin
```

è·å– EXTERNAL-IP åè®¿é—® `http://EXTERNAL-IP:3680`

### ä½¿ç”¨ Ingress

å¦‚æœå¯ç”¨äº† Ingressï¼Œå¯ä»¥é€šè¿‡é…ç½®çš„åŸŸåè®¿é—®ï¼š

- API æœåŠ¡ï¼šé€šè¿‡é…ç½®çš„ `app.api.ingress.hosts` åŸŸåè®¿é—®
- Admin åå°ï¼šé€šè¿‡é…ç½®çš„ `app.admin.ingress.hosts` åŸŸåè®¿é—®

## æ•°æ®å¤‡ä»½

### PostgreSQL æ•°æ®åº“å¤‡ä»½

æœ¬ç³»ç»Ÿä½¿ç”¨ PostgreSQL æ•°æ®åº“ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œæ•°æ®å¤‡ä»½ï¼š

**æ–¹æ³•ä¸€ï¼šä½¿ç”¨ pg_dumpï¼ˆæ¨èï¼‰**

```bash
# è¿æ¥åˆ° PostgreSQL å¹¶å¤‡ä»½æ•°æ®åº“
kubectl exec -it deployment/cherry-studio-enterprise -- pg_dump -h $DB_HOST -U $DB_USERNAME $DB_NAME > backup.sql
```

**æ–¹æ³•äºŒï¼šé€šè¿‡åº”ç”¨æ•°æ®ç›®å½•å¤‡ä»½**

å¦‚æœéœ€è¦å¤‡ä»½åº”ç”¨çš„å…¶ä»–æ•°æ®æ–‡ä»¶ï¼Œæ•°æ®å­˜å‚¨åœ¨ PVC ä¸­ã€‚å¤‡ä»½æ•°æ®çš„æ–¹æ³•ï¼š

```bash
# åˆ›å»ºå¤‡ä»½ pod
kubectl run backup-pod --image=busybox --restart=Never \
  --overrides='{"spec":{"containers":[{"name":"backup","image":"busybox","command":["sleep","3600"],"volumeMounts":[{"name":"data","mountPath":"/backup"}]}],"volumes":[{"name":"data","persistentVolumeClaim":{"claimName":"cherry-studio-enterprise-data"}}]}}'

# ç­‰å¾… pod å¯åŠ¨
kubectl wait --for=condition=ready pod/backup-pod --timeout=60s

# åœ¨å¤‡ä»½ pod ä¸­æ‰“åŒ…æ•°æ®
kubectl exec backup-pod -- tar -czf /tmp/backup.tar.gz -C /backup .

# å¤åˆ¶å¤‡ä»½æ–‡ä»¶åˆ°æœ¬åœ°
kubectl cp backup-pod:/tmp/backup.tar.gz ./backup.tar.gz

# åˆ é™¤å¤‡ä»½ pod
kubectl delete pod backup-pod
```

### å¤‡ä»½è„šæœ¬ï¼ˆæ¨èï¼‰

ä¸ºäº†ç®€åŒ–å¤‡ä»½è¿‡ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è„šæœ¬ï¼š`helm/scripts/backup-database.sh`

### å¤‡ä»½æ•…éšœæ’é™¤

å¦‚æœé‡åˆ° "timed out waiting for the condition" é”™è¯¯ï¼š

1. **æ£€æŸ¥ PVC åç§°æ˜¯å¦æ­£ç¡®**ï¼š

   ```bash
   kubectl get pvc
   ```

2. **æ£€æŸ¥ pod çŠ¶æ€**ï¼š

   ```bash
   kubectl get pod backup-pod
   kubectl describe pod backup-pod
   ```

3. **æ‰‹åŠ¨æ¸…ç†å¤±è´¥çš„ pod**ï¼š

   ```bash
   kubectl delete pod backup-pod --force --grace-period=0
   ```

4. **ä½¿ç”¨åˆ†æ­¥å¤‡ä»½**ï¼š

   ```bash
   # åˆ›å»º podï¼ˆä¸ä½¿ç”¨ --rm å‚æ•°ï¼‰
   kubectl run backup-pod --image=busybox --restart=Never \
     --overrides='{"spec":{"containers":[{"name":"backup","image":"busybox","command":["sleep","300"],"volumeMounts":[{"name":"data","mountPath":"/backup"}]}],"volumes":[{"name":"data","persistentVolumeClaim":{"claimName":"cherry-studio-enterprise-data"}}]}}'

   # ç­‰å¾… pod å°±ç»ª
   kubectl wait --for=condition=ready pod/backup-pod --timeout=60s

   # æ‰§è¡Œå¤‡ä»½
   kubectl exec backup-pod -- tar -czf /tmp/backup.tar.gz -C /backup .

   # å¤åˆ¶æ–‡ä»¶
   kubectl cp backup-pod:/tmp/backup.tar.gz ./backup.tar.gz

   # åˆ é™¤ pod
   kubectl delete pod backup-pod
   ```

## å‡çº§

```bash
# å‡çº§åˆ°æ–°ç‰ˆæœ¬
helm upgrade cherry-studio-enterprise ./helm

# å‡çº§å¹¶æ›´æ–°é…ç½®
helm upgrade cherry-studio-enterprise ./helm -f values-custom.yaml
```

## å¸è½½

```bash
# å¸è½½ chart
helm uninstall cherry-studio-enterprise

# æ‰‹åŠ¨åˆ é™¤ PVCï¼ˆå¦‚æœéœ€è¦ï¼‰
kubectl delete pvc cherry-studio-enterprise-data
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Pod ä¸€ç›´å¤„äº Pending çŠ¶æ€**

   - æ£€æŸ¥èŠ‚ç‚¹èµ„æºæ˜¯å¦å……è¶³
   - ç¡®è®¤ PVC èƒ½å¤Ÿæ­£å¸¸åˆ›å»ºå’Œç»‘å®š

2. **æœåŠ¡æ— æ³•è®¿é—®**

   - æ£€æŸ¥ Service å’Œ Endpoints æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤é˜²ç«å¢™è§„åˆ™

3. **æ•°æ®ä¸¢å¤±**
   - ç¡®è®¤ PVC é…ç½®æ­£ç¡®
   - æ£€æŸ¥å­˜å‚¨ç±»æ˜¯å¦æ”¯æŒæŒä¹…åŒ–

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹ pod æ—¥å¿—
kubectl logs -l app.kubernetes.io/name=cherry-studio-enterprise

# æŸ¥çœ‹ pod è¯¦ç»†ä¿¡æ¯
kubectl describe pod -l app.kubernetes.io/name=cherry-studio-enterprise
```

## é›†ç¾¤é…ç½®å‚è€ƒ

æ ¹æ®ä¼ä¸šç”¨æˆ·è§„æ¨¡ï¼Œä»¥ä¸‹æ˜¯æ¨èçš„é›†ç¾¤é…ç½®æ–¹æ¡ˆï¼š

### é…ç½®è§„æ ¼å»ºè®®

| ç”¨æˆ·è§„æ¨¡ | èŠ‚ç‚¹é…ç½® | èŠ‚ç‚¹æ•°é‡ | Pod å‰¯æœ¬æ•° | å­˜å‚¨å®¹é‡ |
|---------|---------|---------|-----------|----------|
| **0-50äºº** | 2 vCPU, 4GB RAM | 1-2ä¸ª | 1 | 10-20GB |
| **50-200äºº** | 4 vCPU, 8GB RAM | 2-3ä¸ª | 1-2 | 20-50GB |
| **200-1000äºº** | 8 vCPU, 16GB RAM | 3-5ä¸ª | 2-3 | 50-100GB |
| **2000äººä»¥ä¸Š** | 16 vCPU, 32GB RAM | 5+ä¸ª | 3-5 | 100GB+ |

### èµ„æºä½¿ç”¨è¯´æ˜

Cherry Studio Enterprise æ˜¯ä¸€ä¸ªè½»é‡çº§åº”ç”¨ï¼š
- **å†…å­˜å ç”¨**ï¼šå¯åŠ¨åçº¦ 100-150MB
- **CPU ä½¿ç”¨**ï¼šæ­£å¸¸è¿è¡Œæ—¶ < 100m
- **æ•°æ®åº“è´Ÿè½½**ï¼šæä½ï¼Œä¸»è¦å­˜å‚¨é…ç½®æ•°æ®
- **å­˜å‚¨éœ€æ±‚**ï¼šä¸»è¦ç”¨äºæ—¥å¿—å’Œä¸´æ—¶æ–‡ä»¶

å› æ­¤ï¼Œå³ä½¿æ˜¯å°è§„æ ¼çš„é›†ç¾¤ä¹Ÿèƒ½æ”¯æ’‘è¾ƒå¤šç”¨æˆ·ã€‚å»ºè®®æ ¹æ®å®é™…ç›‘æ§æ•°æ®åŠ¨æ€è°ƒæ•´èµ„æºåˆ†é…ã€‚

### æ•°æ®åº“é…ç½®

åº”ç”¨å¯¹æ•°æ®åº“è¦æ±‚å¾ˆä½ï¼Œæ¨èé…ç½®ï¼š
- **å°å‹éƒ¨ç½²ï¼ˆ< 200äººï¼‰**ï¼šå•ä¸ª PostgreSQL å®ä¾‹ï¼ˆ2 vCPU, 4GB RAMï¼‰
- **å¤§å‹éƒ¨ç½²ï¼ˆ> 200äººï¼‰**ï¼šPostgreSQL ä¸»ä»å¤åˆ¶ï¼Œä¸»è¦ç”¨äºæé«˜å¯ç”¨æ€§è€Œéæ€§èƒ½

## æ³¨æ„äº‹é¡¹

1. **å®ä¾‹å»ºè®®**ï¼šè™½ç„¶ä½¿ç”¨ PostgreSQL æ•°æ®åº“ï¼Œä½†ä¸ºäº†ä¿è¯æ•°æ®ä¸€è‡´æ€§å’Œåº”ç”¨çŠ¶æ€ç®¡ç†ï¼Œå»ºè®®è¿è¡Œå•ä¸ª podã€‚å¦‚éœ€é«˜å¯ç”¨ï¼Œè¯·é…ç½® PostgreSQL æ•°æ®åº“çš„ä¸»ä»å¤åˆ¶ã€‚

2. **æ•°æ®æŒä¹…åŒ–**ï¼šç¡®ä¿é›†ç¾¤æ”¯æŒæŒä¹…åŒ–å­˜å‚¨ï¼Œå¦åˆ™æ•°æ®ä¼šåœ¨ pod é‡å¯æ—¶ä¸¢å¤±ã€‚

3. **JWT å¯†é’¥å®‰å…¨**ï¼š

   - ç”Ÿäº§ç¯å¢ƒä¸­å¿…é¡»æ›´æ¢é»˜è®¤çš„ JWT_SECRET
   - å»ºè®®ä½¿ç”¨ Kubernetes Secret ç®¡ç†æ•æ„Ÿä¿¡æ¯
   - JWT å¯†é’¥åº”è¯¥æ˜¯å¼ºéšæœºå­—ç¬¦ä¸²ï¼ˆå»ºè®®è‡³å°‘ 32 å­—ç¬¦ï¼‰

4. **å¤‡ä»½ç­–ç•¥**ï¼šå®šæœŸå¤‡ä»½ PVC ä¸­çš„æ•°æ®ï¼Œä»¥é˜²æ•°æ®ä¸¢å¤±ã€‚

5. **ç½‘ç»œå®‰å…¨**ï¼š
   - ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ Ingress + TLS
   - é™åˆ¶ç½‘ç»œè®¿é—®æƒé™
   - å®šæœŸæ›´æ–°é•œåƒç‰ˆæœ¬

### ç”Ÿäº§ç¯å¢ƒ JWT é…ç½®ç¤ºä¾‹

```yaml
# ä½¿ç”¨ Secret ç®¡ç† JWT å¯†é’¥
apiVersion: v1
kind: Secret
metadata:
  name: cherry-studio-jwt-secret
type: Opaque
data:
  jwt-secret: <base64-encoded-strong-random-string>
---
# åœ¨ values.yaml ä¸­å¼•ç”¨
app:
  env:
    JWT_SECRET:
      valueFrom:
        secretKeyRef:
          name: cherry-studio-jwt-secret
          key: jwt-secret
```
